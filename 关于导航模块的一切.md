# 首先是需求，以及各个需求的大体实现思路

## 输入课程名称导航

- 学生输入课程名称，从课程总仓找到相应的课程，然后找到上课地点，然后导航。
- 问题1：
  - 大部分的课程的上课地点都是教室的编号，诸如$N207$这样的，但是我们的地图是以建筑物为最小单位的，没办法具体到哪个教室那个尺度。
  - 解决方法：修改一下`Course`类，给它新增一个字段，这个字段记录了上课地点所在的建筑物的编号，查找到课程之后通过编号查找建筑物。



## 输入上课时间导航

- 学生输入上课时间，查找学生的个人课表，然后，进行导航。
- 输入上课时间的格式？只需要输入周几几点就可以了吧？还是要年月日时分秒都输入？个人偏向于输入周几几点。PPT上这么写的。

## 输入上课地点导航

- 学生输入上课地点的话，让他输入建筑物的名称，不要具体到输入哪个教室，然后再导航。

# 然后是各个导航策略的实现思路

## 最短距离策略

- 交通方式：在校区内默认步行，赶往另外一个校区的时候坐公交车或者校车。
- 所以需要我们对校车的时刻表以及公交车的发车时刻表做一个规划，这俩都自行规划即可。
- 建立第一类地图，以各个互联的建筑之间的距离为权重的地图。
  - 沙河校区一个地图，本部一个地图
  - 两个校区之间我们考虑只有一条公共通路即可，这一条就是最短的，**因为不管是校车还是公交车，它的行进线路都是固定不变的**
    - 因而我们认为，不管在哪一种导航策略中，乘坐校车或公交车时，所花费的时间和距离都是固定不变的。
    - 不是说乘坐校车和乘坐公交车的时间距离一样，是说不管采用哪一种策略导航，乘坐校车的时间和距离都固定不变，公交车以此类推。
- 非跨校区的，直接校内使用最短路径算法即可。
- 跨校区的，分别在两个地图内部使用最短路径算法之后，再添加上从其中一个校区门口到另外一个校区门口即可。

## 最短时间策略

- 交通方式：在校区内同样默认步行，赶往另一个校区时乘坐公交车或校车
- 建立第二类地图，以各个互联建筑之间步行行走时道路的拥挤度为权重。
  - **需要指出的是，拥挤度之和最小的路径不一定是最短时间的路径，因为拥挤度之和最小的路径也许在距离上恰好是最大的，不能保证时间最短**
  - 还需要设定一个步行理想速度，真实速度 = 理想速度 * 拥挤度
  - 以步行时间为权重并不需要和第一类地图保持一致性，因为我们引入了拥挤度的概念，距离短的路往往拥挤度高，可能并不是时间最短的路。
- 所以我觉得可以改进一下第二类地图的权重，还是以各个互联建筑之间步行行走时所花费的时间为权重。
  - 通过第一类地图我们可以知道每条路的距离
  - 每条路的距离除以这条路上步行的真实速度，就可以得到这条路上花费的实际时间，可以作为边的权值。
  - 对于这个地图就可以直接使用最短路径算法了
- 当然，也可以不改变，只需要在计算最短路径的时候，以花费的时间作为衡量标准即可。
  - 也就是在衡量时，先读取边的拥挤度权值，然后计算出时间，以时间为最终的权值，本质上是一样的。
  - 不能直接对拥挤度为权的图使用最短路径算法。

## 交通工具的最短时间策略

- 根据上次开会的讨论，按照我们当时确定的方案来说，这一类最终是回归到了第二类策略之上了。
- 建立第三类图，这类图的每一条边都有一个权值的集合，这个权值的集合分别对应采用不同交通方式时道路的拥挤度。
- 在导航前，我们对图的每一条边都选出权值最小的那种交通方式作为这条边的权值，然后建立一个新的图。
- 然后回归到第二类的解决方法。

# 然后是各个类

## WeightedEdge

- 翻译过来就是有权边，这个是作为邻接表的某一行的某一项的。

- 将两个顶点以及连接它们的一条边以及边的权绑定在一起。这样说可能不太好理解。

- 举个例子

- 0.2 0.4 0.6 0.8 0.9
  
  ```java
  假设有A B C D E F 六个点，从0依次编号，A和BCD相连，各边权为1 1 4 ，E和BDF相连，各边权为5 1 4
  有权边的第一项项为邻居点，第二个项为边的权重。
      为啥叫中心点，因为邻接表的每一行都是以这个点为中心向四周发散，得到它的所有邻居点
  则邻接表长这样：竖的是一列数组，横的一行是一行LinkedList，反正横竖都是某一种List，整个对象就是List<List<WeightedEdge>>
  这里方便起见，将编号直接用点的名称代替了
  A->(B,{})->(C,1)->(D,4)，这里A是中心点（起点）
  B->(A,1)，这里B是中心点（起点）
  C->(A,1)
  D->(A,1)->(E,5)
  E->(B,5)->(D,1)->(F,4)
  F->(E,4)
  ```
  
- ~~一些说明：~~**都不重要了，不用看，我发现我最开始的想法是可以实行的，只需要稍微修改一下equals()方法**

  - ~~这个类的`equals()`方法是我override过的，只要两条边的两个端点相同，这两条边就看做是同一条边，毕竟我们这里不存在多重图。~~

  - ~~**有权边的第一项为起点（中心点），第二项为邻居点，第三个项为边的权重。**这个很重要。。别问，问就是妥协。。~~

    - ~~为啥叫中心点，因为邻接表的每一行都是以这个点为中心向四周发散，得到它的所有邻居点~~
    - ~~在哪里妥协：~~
      - ~~在得到某个点的所有邻居的方法中，用户期望得到的应该是邻居的编号的集合，而不是有权边的集合~~
      - ~~所以我们只能先得到有权边的集合，再从边中取出点的编号，如果不规定第二项是邻居点的编号，那没办法做下去了。。~~
      - ~~所以规定第二项是邻居点的编号~~

  - ~~**为什么有权边非得把两个端点都包含进去？别问，问就是妥协。。。**~~ 

    - ~~其实一开始的表应该长下面这样的，但是我发现这样的话带来了另外一个问题。~~

    - ```java
      A->(B,{拥挤度对象：早上 中午 晚上})->(C,1)->(D,4)，这里A是中心点（起点）
      B->(A,1)，这里B是中心点（起点）
      C->(A,1)
      D->(A,1)->(E,5)
      E->(B,5)->(D,1)->(F,4)
      F->(E,4)
      ```

    - ~~问题在于：在给某两个点添加边的时候，用户期望的是输入两个点的编号V1和V2以及边的权值W，即可添加一条边。~~

      - ~~在这个过程中，我们首先要查看这两个点是不是已经相连了嘛，那就要查看V1（V2）行的list是否有V2（V1）项呗。~~
      - ~~后面发现对之前我建立无权图的时候的代码改动起来不太方便，就妥协了一下。。不细说了。。~~

  - ~~使用这个类的`getVertexNumber1()`得到边的中心点（起点），`getVertexNumber2()`得到邻居点~~



## BuptGraph

- 最基本的图类，沙河校区地图和本部的地图都扩展了这个类。
- 作为图所拥有的基本的那些方法，添加边（把两个点连起来）、得到某个点的邻居的集合、得到边的数目和点的数目。
- 在最开始的时候需要指定点的数目（也就是地图中建筑的数目来构造图）
- 所有的点最开始都是孤立的。
- 有权图，使用邻接表作为基本结构

## ShaHeMap & XiTuChengMap	

- 咨询过老师，两个校区的建筑数之和不小于20即可，所以我对此前的地图做了一些精简。
  - 沙河校区就这些：
    - <img src="https://raw.githubusercontent.com/CorneliaStreet1/PictureBed/master/202205171710851.png" alt="image-20220517171046687"  />
  - 本部就这些：
    - ![image-20220517171218757](https://raw.githubusercontent.com/CorneliaStreet1/PictureBed/master/202205171712851.png)
- **请注意，只有沙河校区地图类和西土城校区地图类，才能够实现输入一个建筑名，得到建筑的编号。**单独的BuptGraph类是只能返回null值的。
- 这个地图的权值可以是两种情况：
  - 以距离为权值，对应最短距离策略。
  - 以步行时的拥挤度为权值，对应最短时间策略。
  - 并不能作为交通工具的最短时间策略的地图载体，由于底层实现的关系，每条边都只有一个权值，而不是一个权值的集合。
    - 而我们是使用一个权值的集合来描述同一条路的不同交通工具情况下的拥挤度的。
- 对于以距离为权值的情况，每个校区都只有一个地图，因为距离并不随时间变化。
- 对于以步行时的拥挤度为权值，每个校区有三个地图？分别对应早中晚三个时间段？
  - 早八？
  - 中午吃饭？
  - 傍晚，还是半夜？
  - 还有一个问题没有解决：同一条路上两个方向拥挤度不同？说实话我想摆烂，不想考虑这个。。

# 然后是公交车和校车的发车时间表



- 这个主要是提供跨校区的交通。

- 应该不用考虑拥挤度的影响吧？

- 公交车的发车表的安排应该要结合课表吧？

- 公交车应该要比校车慢一些，因为公交车要经停很多个站，而校车是直达的？

- 必须要保证公交车和校车不是任意时刻都同时可以乘坐的，否则公交车是无意义的。

- ```java
  一天内的课表时间段：
  8:00 - 8:45	8:50 - 9:35	9:50 - 10:35 10:40-11:25 11:30-12:15 13:00-13:45 13:50-14:35 14:45-15:30 15:40-16:25
  公交车：每15分钟一辆，但是要比校车慢10 ？
  校车：每半小时一辆？
  ```

  
